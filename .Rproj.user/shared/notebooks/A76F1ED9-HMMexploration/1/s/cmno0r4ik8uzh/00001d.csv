"0","data_age_hr<-calf_demo[,c(1,3,4,5,7,13)]"
"0","#want to get rid of the rows with NA values for the DSB"
"0","data_age_hr <- na.omit(data_age_hr)"
"0",""
"0","data_aghr_prep<-prepData(data_age_hr, type='LL',coordNames = NULL, covNames=c(""DSB"",""hour""))"
"0",""
"0","#Effects of the covariates on the variable probability distributions"
"0","speedDM<-list(mean=~DSB, sd=~DSB)"
"0","depthDM<-list(mean=~DSB, sd=~DSB)"
"0","mrlDM<-list(shape1=~1, shape2=~1)"
"0",""
"0","#BOTH covariates effects on the transition probabilities"
"0","formula <- ~ DSB + cosinor(hour, period = 24)"
"0",""
"0","dist<-list("
"0","  avg_speed=""gamma"","
"0","  mrl=""beta"","
"0","  max_depth=""gamma"""
"0","  )"
"0",""
"0","Par0 <- list( "
"0","  avg_speed = c("
"0","    rest_params['alpha'], travel_params['alpha'], "
"0","    rest_params['beta'],  travel_params['beta']"
"0","  ),"
"0","  mrl= c("
"0","    rest_mrl_params['alpha'], travel_mrl_params['alpha'], "
"0","    rest_mrl_params['beta'],  travel_mrl_params['beta']"
"0","  ), "
"0","  max_depth=c("
"0","    rest_depth_params['alpha'], travel_depth_params['alpha'], "
"0","    rest_depth_params['beta'],  travel_depth_params['beta']"
"0","  )"
"0",")"
"0",""
"0","#have to do this so the Par and DM match or something"
"0","Par1<-getParDM(data = data_aghr_prep, "
"0","               nbStates = 2, "
"0","               dist = list(avg_speed=""gamma"",mrl=""beta"",max_depth=""gamma""), "
"0","               Par=Par0, "
"0","               DM=list(avg_speed=list(mean=~DSB, sd=~DSB), mrl=list(shape1=~1, shape2=~1), max_depth=list(mean=~DSB, sd=~DSB))"
"0","               )"
"0",""
"0","stateNames <- c(""traveling"",""resting"")"
"0",""
"0","test_2cov <- fitHMM("
"0","  data_aghr_prep, "
"0","  nbStates=2, "
"0","  dist=dist, "
"0","  DM=list("
"0","    avg_speed=speedDM, "
"0","    mrl=mrlDM, "
"0","    max_depth=depthDM), "
"0","  Par0=Par1, "
"0","  stateNames=stateNames,"
"0","  formula=formula"
"0",")"
"2","=======================================================================
"
"2","Fitting HMM with 2 states and 3 data streams
"
"2","-----------------------------------------------------------------------

"
"2"," avg_speed ~ gamma(mean=~DSB, sd=~DSB)
"
"2"," mrl ~ beta(shape1=~1, shape2=~1)
"
"2"," max_depth ~ gamma(mean=~DSB, sd=~DSB)
"
"2","
 Transition probability matrix formula: ~DSB + cosinor(hour, period = 24)
"
"2","
 Initial distribution formula: ~1
"
"2","=======================================================================
"
"2","DONE
"
"0","print(test_2cov)"
"1","Value of the maximum log-likelihood:"
"1"," "
"1","-2803.63"
"1"," "
"1","

"
"1","
"
"1","Regression coeffs for"
"1"," "
"1","avg_speed"
"1"," "
"1","parameters:
"
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","----------------------------------
"
"1","    "
"1"," mean_1:(Intercept)"
"1","  mean_1:DSB"
"1"," mean_2:(Intercept)"
"1","  mean_2:DSB"
"1"," sd_1:(Intercept)"
"1","     sd_1:DSB"
"1"," sd_2:(Intercept)"
"1","   sd_2:DSB"
"1","
[1,]"
"1","          0.3391065"
"1"," 0.000190494"
"1","         -0.2062655"
"1"," 0.004083596"
"1","       -0.7230508"
"1"," -0.004876368"
"1","        -1.999459"
"1"," 0.00790479"
"1","
"
"1","
"
"1","avg_speed"
"1"," "
"1","parameters (based on mean covariate values):
"
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","---------------------------------------------
"
"1","    "
"1"," traveling"
"1","   resting"
"1","
mean"
"1"," 1.4134783"
"1"," 0.9442714"
"1","
sd  "
"1"," 0.4062096"
"1"," 0.1806524"
"1","
"
"1","
"
"1","mrl"
"1"," "
"1","parameters:
"
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","------------
"
"1","      "
"1"," traveling"
"1","  resting"
"1","
shape1"
"1"," 4.5301347"
"1"," 2.053395"
"1","
shape2"
"1"," 0.8324654"
"1"," 1.673446"
"1","
"
"1","
"
"1","Regression coeffs for"
"1"," "
"1","max_depth"
"1"," "
"1","parameters:
"
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","----------------------------------
"
"1","    "
"1"," mean_1:(Intercept)"
"1","  mean_1:DSB"
"1"," mean_2:(Intercept)"
"1"," mean_2:DSB"
"1"," sd_1:(Intercept)"
"1","    sd_1:DSB"
"1"," sd_2:(Intercept)"
"1","  sd_2:DSB"
"1","
[1,]"
"1","           3.372792"
"1"," 0.001980866"
"1","           2.597269"
"1"," 0.01204719"
"1","         3.202085"
"1"," 0.001101245"
"1","        0.9924039"
"1"," 0.0185544"
"1","
"
"1","
"
"1","max_depth"
"1"," "
"1","parameters (based on mean covariate values):
"
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","-"
"1",""
"1","---------------------------------------------
"
"1","    "
"1"," traveling"
"1","   resting"
"1","
mean"
"1","  31.34429"
"1"," 20.834612"
"1","
sd  "
"1","  25.59113"
"1","  5.307182"
"1","
"
"1","
"
"1","Regression coeffs for the transition probabilities:
"
"1","---------------------------------------------------
"
"1","                             "
"1","       1 -> 2"
"1","       2 -> 1"
"1","
(Intercept)                  "
"1"," -1.312162197"
"1"," -2.483518882"
"1","
DSB                          "
"1"," -0.006719773"
"1","  0.007168317"
"1","
cosinorCos(hour, period = 24)"
"1","  0.356575600"
"1","  0.025662537"
"1","
cosinorSin(hour, period = 24)"
"1","  0.118577302"
"1"," -0.957925162"
"1","
"
"1","
"
"1","Transition probability matrix (based on mean covariate values):
"
"1","---------------------------------------------------------------
"
"1","         "
"1"," traveling"
"1","   resting"
"1","
traveling"
"1"," 0.8735691"
"1"," 0.1264309"
"1","
resting  "
"1"," 0.1227912"
"1"," 0.8772088"
"1","
"
"1","
"
"1","Initial distribution:
"
"1","---------------------
"
"1","  traveling "
"1","    resting "
"1","
"
"1","0.997910804 "
"1","0.002089196 "
"1","
"
"0","plot(test_2cov, plotCI = TRUE, breaks=30, sepStates=TRUE, ask=TRUE)"
"1","Decoding state sequence... "
"1","DONE
"
